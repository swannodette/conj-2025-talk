#+title: A ClojureScript Survival Kit
#+date: Clojure/conj 2025
#+author: David Nolen
#+email: david.nolen@gmail.com
#+STARTUP: indent inlineimages

* [[elisp:(my/org-present-inferior-clojure "clojure -M -m cljs.main -d .cljs_repl -re node -r")][Demo]]
#+begin_src clojure
  (println "Hello Clojure/conj 2025!!")
  (map #(* % %)
    (filter even? (take 10 (range))))
  (assoc {:foo 1} :foo 2)
  (doc js/Array.indexOf)
  (doc js/HTMLElement)
#+end_src
* What is ClojureScript?
** A dialect of Clojure that targets JavaScript runtimes
*** Delivers a significant slice of `clojure.core`
** Includes a very large standard library via Google Closure Library (GCL)
*** More on that later ...
** REPL integration with JavaScript runtimes (Browser, Node.js)
*** Interactive development from your environment of your choice
** Tightly integrated with Google Closure Compiler Advanced Optimizations
*** A trivial `cljs.core` program (+ GCL) is ~3mb
**** After advanced compilation 3 bytes
*** More on that later ...
* Post-apocalyptic Software Development: A Fairy Tale
üñ•üíÄüßö
** Software Zombie Apocalypse!
*** Everyone expects X to solve their probablem
** What if you can't get to NPM!
** What if you can't use any ClojureScript libraries!
** Living on your wits, your bare hands, and a few simple but powerful tools
* A Survival Kit
** Reviewing what we get out of the box with ClojureScript
*** cljs.core
*** goog.*
** The browsers have greatly improved since React was released
*** Can move a =considerable= amount of logic into new DOM APIs, CSS
** Remix older lessons with newer lessons
*** AJAX / HTMX
*** Even you could write your own morphing library!
* JavaScript Today
:PROPERTIES:
:org-image-actual-width: 800
:END:
[[file:fine.jpg]]
* JavaScript Tomorrow
:PROPERTIES:
:org-image-actual-width: 800
:END:

[[file:homer.gif]]
* Easy vs. Simple
** Micro-modules, loading deps N times, and deep dependency graphs
** Semantic versioning ü§°
** React is not the problem
*** The mentality cuts across framework choices
**** Addiction to trivial dependencies
* ClojureScript & JS Status Quo
** Clojure community lead the jump to React
** But 10+ years on, perhaps time to lead the way again
** ClojureScript + React is practical
* Where did we go wrong?
** Adopting JavaScript complexity regardless of fit
** Losing sight of the fundamentals
** Adopt the good ideas lead the way again
* Clojurescript Fundamentals
** A dialect of Clojure targeting JavaScript
** Leverage Google Closure Compiler
** Leverage Google Closure Library
* Google Closure Library
** Google stopped maintaining it (externally)
*** So we forked it
** Still a rock solid option for a great many tasks
** Written with a 
* Advanced Compilation
** Pay for what you use
#+begin_src clojure
(.log js/console "Hello world!")
#+end_src
** Closure understand unused literals
** Two aspects of ClojureScript dead code elimination challenging
*** All the data structures refer to each other
*** Printing
* Lite Mode
** Use the original copy-on-write data structures
*** Much simpler implementations
** `:elide-to-string`
*** printing has to know about all the types
** The following is 6K brotli
#+begin_src clojure
  (->> (map inc (range 10))
    (filter even?)
    (partition 2)
    (drop 1)
    (mapcat identity)
    into-array))
#+end_src
* Light DOM Web Components
** Web Components for a long time synonymous w/ Shadow DOM
*** Shadow DOM is complected
*** If you decomplect
**** plain Web Components
** Web Components work more or less like native components
*** Thus they work with every framework
*** They work with any diffing approach
* Where is all this stuff coming from?
** Source Map Explorer
* Introspect DOM APIs at REPL
* How can I manipulate the DOM?
** Setting attributes
** Setting styles
* How can I listen for events
** Can I listen for multiple events
** Can I delegate events
* How can I make a custom component
** Can update that component in a functional way?
* How can I build an app?
** Client/Server state management
*** Synchronization complexity
** Client state management
*** Synchronization complexity
** Server management
*** Hrm ...
* The Book of AJAX
** innerHTML/outerHTML
* The Book of React
** Diffing the DOM
** Idiomorph
* Smoothing things out
** Using Google Closure to disambiguate methods / namespaces / fields
* Why ClojureScript in 2025?
** Functional programming
** REPL Driven Development
** Batteries included
** Maximum functionality / Minimal Artifact
** Radically different approach software development
* Thank You!
* Why not just TypeScript?
** Another brick in the wall 
** We can assert our differing philosophies without abandoning our responsibilities
*** The Lisp Curse?
* Presentation Variables
# Local Variables:
# fill-column: 80
# word-wrap: t
# org-hide-leading-stars: t
# org-modern-star: replace
# org-modern-replace-stars: ("¬ß" "‚ùØ" "‚óã" "‚ñ†" "‚òÖ")
# image-animate-loop: t
# eval: (when org-modern-mode (org-modern-mode -1) (org-modern-mode 1))
# eval: (my/animate-images)
# End:
